<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keuangan Harian</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen py-6 px-3">
  <div class="max-w-3xl mx-auto bg-white shadow-md rounded-xl p-4 sm:p-6">
    <h1 class="text-2xl font-bold mb-4 text-center">Aplikasi Keuangan Harian</h1>

    <!-- Form -->
    <form id="form-transaksi" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
      <input type="date" id="tanggal" class="border p-2 rounded w-full" required>
      <select id="jenis" class="border p-2 rounded w-full" required>
        <option value="pemasukan">Pemasukan</option>
        <option value="pengeluaran">Pengeluaran</option>
      </select>
      <input type="number" id="jumlah" class="border p-2 rounded w-full" placeholder="Jumlah (Rp)" required>
      <input type="text" id="deskripsi" class="border p-2 rounded w-full" placeholder="Deskripsi" required>
      <button type="submit" class="sm:col-span-2 bg-green-500 hover:bg-green-600 text-white py-2 rounded w-full">
        Tambah Transaksi
      </button>
    </form>

    <!-- Ringkasan -->
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 text-white">
      <div class="bg-blue-500 p-4 rounded-xl">
        <p>Total Pemasukan</p>
        <h2 id="total-pemasukan" class="text-xl font-bold">Rp0</h2>
      </div>
      <div class="bg-red-500 p-4 rounded-xl">
        <p>Total Pengeluaran</p>
        <h2 id="total-pengeluaran" class="text-xl font-bold">Rp0</h2>
      </div>
      <div class="bg-gray-700 p-4 rounded-xl">
        <p>Saldo</p>
        <h2 id="saldo" class="text-xl font-bold">Rp0</h2>
      </div>
    </div>

    <!-- Riwayat -->
    <h2 class="text-lg font-semibold mb-2">Riwayat Transaksi</h2>
    <div class="overflow-x-auto">
      <table class="w-full text-left border">
        <thead class="bg-gray-200">
          <tr>
            <th class="p-2 border">Tanggal</th>
            <th class="p-2 border">Jenis</th>
            <th class="p-2 border">Jumlah</th>
            <th class="p-2 border">Deskripsi</th>
          </tr>
        </thead>
        <tbody id="tabel-transaksi"></tbody>
      </table>
    </div>
  </div>

  <script>
    const form = document.getElementById('form-transaksi');
    const tabel = document.getElementById('tabel-transaksi');
    const totalPemasukanEl = document.getElementById('total-pemasukan');
    const totalPengeluaranEl = document.getElementById('total-pengeluaran');
    const saldoEl = document.getElementById('saldo');

    let transaksi = JSON.parse(localStorage.getItem('transaksi')) || [];

    function simpanTransaksi() {
      localStorage.setItem('transaksi', JSON.stringify(transaksi));
    }

    function formatRupiah(angka) {
      return 'Rp' + angka.toLocaleString('id-ID');
    }

    function formatTanggal(date) {
      const options = { year: 'numeric', month: '2-digit', day: '2-digit' };
      return new Date(date).toLocaleDateString('id-ID', options).replace(/\//g, '-');
    }

    function renderTabel() {
      tabel.innerHTML = '';
      let totalPemasukan = 0;
      let totalPengeluaran = 0;

      transaksi.forEach(item => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="border p-2">${formatTanggal(item.tanggal)}</td>
          <td class="border p-2 capitalize">${item.jenis}</td>
          <td class="border p-2">${formatRupiah(item.jumlah)}</td>
          <td class="border p-2">${item.deskripsi}</td>
        `;
        tabel.appendChild(tr);

        if (item.jenis === 'pemasukan') totalPemasukan += item.jumlah;
        else totalPengeluaran += item.jumlah;
      });

      totalPemasukanEl.textContent = formatRupiah(totalPemasukan);
      totalPengeluaranEl.textContent = formatRupiah(totalPengeluaran);
      saldoEl.textContent = formatRupiah(totalPemasukan - totalPengeluaran);
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const data = {
        tanggal: document.getElementById('tanggal').value,
        jenis: document.getElementById('jenis').value,
        jumlah: parseInt(document.getElementById('jumlah').value),
        deskripsi: document.getElementById('deskripsi').value
      };
      transaksi.push(data);
      simpanTransaksi();
      renderTabel();
      form.reset();

      // Reset tanggal ke hari ini setelah submit
      document.getElementById('tanggal').value = new Date().toISOString().split('T')[0];
    });

    // Set tanggal default ke hari ini saat load
    document.getElementById('tanggal').value = new Date().toISOString().split('T')[0];

    renderTabel();
  </script>
</body>
</html>
